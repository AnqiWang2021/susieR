<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Sum of Single Effects (SuSiE) Regression using summary statistics — susie_rss • susieR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Sum of Single Effects (SuSiE) Regression using summary statistics — susie_rss" />
<meta property="og:description" content="susie_rss performs variable selection under a
  sparse Bayesian multiple linear regression of \(Y\) on \(X\)
  using only the z-scores from standard univariate regression
  of \(Y\) on each column of \(X\), and an estimate \(R\) of
  the correlation matrix between columns of \(X\). It does this by
  combining the &quot;RSS likelihood&quot; from Zhu and Stephens (2017) with
  the Sum of Single Effects&quot; model from Wang et al (2020)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">susieR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.11.25</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/stephenslab/susieR">Source</a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sum of Single Effects (SuSiE) Regression using summary statistics</h1>
    <small class="dont-index">Source: <a href='https://github.com/stephenslab/susieR/blob/master/R/susie_rss.R'><code>R/susie_rss.R</code></a></small>
    <div class="hidden name"><code>susie_rss.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>susie_rss</code> performs variable selection under a
  sparse Bayesian multiple linear regression of \(Y\) on \(X\)
  using only the z-scores from standard univariate regression
  of \(Y\) on each column of \(X\), and an estimate \(R\) of
  the correlation matrix between columns of \(X\). It does this by
  combining the "RSS likelihood" from Zhu and Stephens (2017) with
  the Sum of Single Effects" model from Wang et al (2020).</p>
    </div>

    <pre class="usage"><span class='fu'>susie_rss</span><span class='op'>(</span>
  <span class='va'>z</span>,
  <span class='va'>R</span>,
  z_ld_weight <span class='op'>=</span> <span class='fl'>0</span>,
  L <span class='op'>=</span> <span class='fl'>10</span>,
  prior_variance <span class='op'>=</span> <span class='fl'>50</span>,
  estimate_prior_variance <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>z</th>
      <td><p>A p-vector of z scores.</p></td>
    </tr>
    <tr>
      <th>R</th>
      <td><p>A p by p symmetric, positive semidefinite correlation
matrix.</p></td>
    </tr>
    <tr>
      <th>z_ld_weight</th>
      <td><p>This parameter is included for backwards
compatibility with previous versions of the function, but it is no
longer recommended to use a non-zero value. If <code>z_ld_weight
&gt; 0</code>, the matrix R used in the model is adjusted to be
<code><a href='https://rdrr.io/r/stats/cor.html'>cov2cor((1-w)*R + w*tcrossprod(z))</a></code>, where <code>w =
z_ld_weight</code>.</p></td>
    </tr>
    <tr>
      <th>L</th>
      <td><p>Maximum number of components (nonzero coefficients) in the
susie regression model. If L is larger than the number of
covariates, p, L is set to p.</p></td>
    </tr>
    <tr>
      <th>prior_variance</th>
      <td><p>The prior variance(s) for the non-zero
element of \(b_l\). It is either a scalar, or a vector of length
L. When <code>estimate_prior_variance = TRUE</code> (highly recommended)
this simply provides an initial value for the prior variance, and
the default value of 50 is simply intended to be a large initial
value.</p></td>
    </tr>
    <tr>
      <th>estimate_prior_variance</th>
      <td><p>If <code>estimate_prior_variance =
TRUE</code>, which is highly recommended, the prior variance is estimated
(this is a separate parameter for each of the L effects). If
provided, <code>prior_variance</code> is then used as an initial value
for the optimization. When <code>estimate_prior_variance = FALSE</code>
(not recommended) the prior variance for each of the L effects is
determined by the value supplied to <code>prior_variance</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other parameters to be passed to
<code><a href='susie.html'>susie_suff_stat</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>"susie"</code> object with the following
  elements:</p>
<dt>alpha</dt><dd><p>An L by p matrix of posterior inclusion probabilites.</p></dd>

<dt>mu</dt><dd><p>An L by p matrix of posterior means, conditional on
  inclusion.</p></dd>

<dt>mu2</dt><dd><p>An L by p matrix of posterior second moments,
  conditional on inclusion.</p></dd>

<dt>lbf</dt><dd><p>log-Bayes Factor for each single effect.</p></dd>

<dt>lbf_variable</dt><dd><p>log-Bayes Factor for each variable and single effect.</p></dd>

<dt>V</dt><dd><p>Prior variance of the non-zero elements of b.</p></dd>

<dt>elbo</dt><dd><p>The value of the variational lower bound, or
  &#8220;ELBO&#8221; (objective function to be maximized), achieved at
  each iteration of the IBSS fitting procedure.</p></dd>

<dt>Rr</dt><dd><p>A vector of length p, equal to <code>R %*% colSums(alpha*mu)</code>.</p></dd>

<dt>sets</dt><dd><p>Credible sets estimated from model fit; see
  <code><a href='susie_get_objective.html'>susie_get_cs</a></code> for details.</p></dd>

<dt>pip</dt><dd><p>A vector of length p giving the (marginal) posterior
  inclusion probabilities for all p covariates.</p></dd>

<dt>niter</dt><dd><p>Number of IBSS iterations that were performed.</p></dd>

<dt>converged</dt><dd><p><code>TRUE</code> or <code>FALSE</code> indicating whether
  the IBSS converged to a solution within the chosen tolerance
  level.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In some applications, particularly genetic applications,
it is desired to fit a regression model (\(Y = X\tilde{b} + E\)
say, which we refer to as "the original regression model" or ORM)
without access to the actual values of \(Y\) and \(X\), but
given only some summary statistics. <code>susie_rss</code> assumes the
availability of \(z\) scores from standard univariate regression
of \(Y\) on each column of \(X\), and an estimate \(R\) of
the correlation matrix between columns of \(X\) (\(R\) is
sometimes called the LD matrix in genetic applications). See Zhu
and Stephens (2017), and references therein, for further
background.</p>
<p>The <code>susie_rss</code> function is based on the model (2.10) from
Zhu and Stephens, \(z | R, b ~ N(Rb,R)\) where \(b\) is a
vector of length p representing the effects to be estimated. The
effect \(b_j\) is simply a multiple of the coefficient
\(\tilde{b}_j\) in the ORM, and so \(b_j\) is non-zero if and
only if \(\tilde{b}_j\) is non-zero. In this sense the variable
selection problem in this model is the same as the variable
selection problem in the ORM, and so the credible sets and PIPs
computed by <code>susie_rss</code> can be interpreted as credible sets
and PIPs for the ORM. However, converting posterior estimates of
\(b_j\) to estimates of \(\tilde{b}_j\) would require
computation of the scaling factor (not done here).</p>
<p>More precisely, <code>susie_rss</code> assumes the log-likelihood for
\(b\) is \(l(b; z,R) = -0.5(b'Rb - 2z'b)\), which is equivalent
to model (2.10) from Zhu and Stephens if \(R\) is invertible, but
does not require \(R\) to be invertible. It combines this
likelihood with the &#8220;susie prior&#8221; which assumes that \(b
= \sum_{l=1}^L b_l\) where each \(b_l\) is a vector of length p
with exactly one non-zero element; see <code><a href='susie.html'>susie</a></code> and Wang
et al (2020) for details.</p>
<p>In practice, this is accomplished by calling <code>susie_suff_stat</code>
with <code>XtX = R</code> and <code>Xty = z</code>, and fixing
<code>residual_variance = 1</code>. (Values for <code>n</code> and <code>yty</code>
are also required by <code>susie_suff_stat</code>. They do not affect
inference when the residual variance is fixed, but they do affect
the interpretation of <code>scaled_prior_variance</code>; we set
<code>n=2, yty=1</code> so that \(var(y) = yty/(n-1) = 1\).) Additional
arguments to be passed to <code><a href='susie.html'>susie_suff_stat</a></code> can be
provided via <code>...</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>G. Wang, A. Sarkar, P. Carbonetto and M. Stephens (2020). A simple
  new approach to variable selection in regression, with application
  to genetic fine-mapping. <em>Journal of the Royal Statistical
  Society, Series B</em> <b>82</b> doi: <a href='https://doi.org/10.1101/501114'>10.1101/501114</a>
.</p>
<p>X. Zhu and M. Stephens (2017). Bayesian large-scale multiple regression
  with summary statistics from genome-wide association studies.
  <em>Annals of Applied Statistics</em> <b>11</b>, 1561-1592.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>n</span> <span class='op'>=</span> <span class='fl'>1000</span>
<span class='va'>p</span> <span class='op'>=</span> <span class='fl'>1000</span>
<span class='va'>beta</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='va'>p</span><span class='op'>)</span>
<span class='va'>beta</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>]</span> <span class='op'>=</span> <span class='fl'>1</span>
<span class='va'>X</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>*</span><span class='va'>p</span><span class='op'>)</span>,nrow <span class='op'>=</span> <span class='va'>n</span>,ncol <span class='op'>=</span> <span class='va'>p</span><span class='op'>)</span>
<span class='va'>X</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>X</span>,center <span class='op'>=</span> <span class='cn'>TRUE</span>,scale <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/drop.html'>drop</a></span><span class='op'>(</span><span class='va'>X</span> <span class='op'>%*%</span> <span class='va'>beta</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>input_ss</span> <span class='op'>=</span> <span class='fu'><a href='compute_suff_stat.html'>compute_suff_stat</a></span><span class='op'>(</span><span class='va'>X</span>,<span class='va'>y</span>,standardize <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>ss</span>   <span class='op'>=</span> <span class='fu'><a href='univariate_regression.html'>univariate_regression</a></span><span class='op'>(</span><span class='va'>X</span>,<span class='va'>y</span><span class='op'>)</span>
<span class='va'>R</span>    <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>input_ss</span>,<span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cov2cor</a></span><span class='op'>(</span><span class='va'>XtX</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>zhat</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>ss</span>,<span class='va'>betahat</span><span class='op'>/</span><span class='va'>sebetahat</span><span class='op'>)</span>
<span class='va'>res</span>  <span class='op'>=</span> <span class='fu'>susie_rss</span><span class='op'>(</span><span class='va'>zhat</span>,<span class='va'>R</span>,L <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Gao Wang, Yuxin Zou, Kaiqian Zhang, Peter Carbonetto, Matthew Stephens.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


