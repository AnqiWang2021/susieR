<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fine-mapping examples • susieR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fine-mapping examples">
<meta property="og:description" content="susieR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">susieR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.52</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/stephenslab/susieR">Source</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fine-mapping examples</h1>
                        <h4 class="author">Gao Wang</h4>
            
            <h4 class="date">2020-10-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stephenslab/susieR/blob/master/vignettes/finemapping.Rmd"><code>vignettes/finemapping.Rmd</code></a></small>
      <div class="hidden name"><code>finemapping.Rmd</code></div>

    </div>

    
    
<p>This vignette demonstrates <code>susieR</code> in the context of genetic fine-mapping. We use simulated data of expression level of a gene (<span class="math inline">\(y\)</span>) in <span class="math inline">\(N \approx 600\)</span> individuals. We want to identify with the genotype matrix <span class="math inline">\(X_{N\times P}\)</span> (<span class="math inline">\(P=1000\)</span>) the genetic variables that causes changes in expression level.</p>
<p>The simulated data-set is <a href="https://github.com/stephenslab/susieR/blob/master/inst/datafiles/N3finemapping.rds">available here</a>, as part of the <code>susieR</code> package. It is simulated to have exactly 3 non-zero effects.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">susieR</span>)
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)</pre></body></html></div>
<div id="the-data-set" class="section level2">
<h2 class="hasAnchor">
<a href="#the-data-set" class="anchor"></a>The data-set</h2>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">N3finemapping</span>)
<span class="fu"><a href="https://rdrr.io/r/base/attach.html">attach</a></span>(<span class="no">N3finemapping</span>)</pre></body></html></div>
<p>The loaded dataset contains regression data <span class="math inline">\(X\)</span> and <span class="math inline">\(y\)</span>, along with some other relevant properties in the context of genetic studies. It also contains the “true” regression coefficent the data is simulated from.</p>
<p>Notice that we’ve simulated 2 sets of <span class="math inline">\(Y\)</span> as 2 simulation replicates. Here we’ll focus on the first data-set.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">Y</span>)
<span class="co"># [1] 574   2</span></pre></body></html></div>
<p>Here are the 3 “true” signals in the first data-set:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">b</span> <span class="kw">&lt;-</span> <span class="no">true_coef</span>[,<span class="fl">1</span>]
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">b</span>, <span class="kw">pch</span><span class="kw">=</span><span class="fl">16</span>, <span class="kw">ylab</span><span class="kw">=</span><span class="st">'effect size'</span>)</pre></body></html></div>
<div class="figure" style="text-align: center">
<img src="finemapping_files/figure-html/unnamed-chunk-4-1.png" alt="&amp;nbsp;" width="600"><p class="caption">
 
</p>
</div>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">b</span> <span class="kw">!=</span> <span class="fl">0</span>)
<span class="co"># [1] 403 653 773</span></pre></body></html></div>
<p>So the underlying causal variables are 403, 653 and 773.</p>
</div>
<div id="simple-regression-summary-statistics" class="section level2">
<h2 class="hasAnchor">
<a href="#simple-regression-summary-statistics" class="anchor"></a>Simple regression summary statistics</h2>
<p><code>univariate_regression</code> function can be used to compute summary statistics by fitting univariate simple regression variable by variable. The results are <span class="math inline">\(\hat{\beta}\)</span> and <span class="math inline">\(SE(\hat{\beta})\)</span> from which z-scores can be derived. Again we focus only on results from the first data-set:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">sumstats</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/univariate_regression.html">univariate_regression</a></span>(<span class="no">X</span>, <span class="no">Y</span>[,<span class="fl">1</span>])
<span class="no">z_scores</span> <span class="kw">&lt;-</span> <span class="no">sumstats</span>$<span class="no">betahat</span> / <span class="no">sumstats</span>$<span class="no">sebetahat</span>
<span class="fu"><a href="../reference/susie_plots.html">susie_plot</a></span>(<span class="no">z_scores</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"z"</span>, <span class="kw">b</span><span class="kw">=</span><span class="no">b</span>)</pre></body></html></div>
<div class="figure" style="text-align: center">
<img src="finemapping_files/figure-html/unnamed-chunk-6-1.png" alt="&amp;nbsp;" width="600"><p class="caption">
 
</p>
</div>
</div>
<div id="fine-mapping-with-susier" class="section level2">
<h2 class="hasAnchor">
<a href="#fine-mapping-with-susier" class="anchor"></a>Fine-mapping with <code>susieR</code>
</h2>
<p>For starters, we assume there are at most 10 causal variables, i.e., set <code>L = 10</code>, although SuSiE is robust to the choice of <code>L</code>.</p>
<p>Notice that by default SuSiE estimates prior effect size from data. For fine-mapping applications, however, we often have some knowledge of SuSiE prior effect size since it is parameterized as percentage of variance explained. Here for this eQTL fine-mapping application we set SuSiE prior variance to 0.1, and update residual variance in the variational algorithm that fits SuSiE model. The <code>susieR</code> function call is:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">fitted</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/susie.html">susie</a></span>(<span class="no">X</span>, <span class="no">Y</span>[,<span class="fl">1</span>],
                <span class="kw">L</span> <span class="kw">=</span> <span class="fl">10</span>,
                <span class="kw">estimate_residual_variance</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                <span class="kw">estimate_prior_variance</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                <span class="kw">scaled_prior_variance</span> <span class="kw">=</span> <span class="fl">0.1</span>,
                <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co"># [1] "objective:-1392.42460921237"</span>
<span class="co"># [1] "objective:-1388.98662572569"</span>
<span class="co"># [1] "objective:-1387.87893344487"</span>
<span class="co"># [1] "objective:-1387.87158194815"</span>
<span class="co"># [1] "objective:-1387.73100740437"</span>
<span class="co"># [1] "objective:-1387.73099852765"</span>
<span class="co"># [1] "objective:-1387.67616609041"</span>
<span class="co"># [1] "objective:-1387.67615783404"</span>
<span class="co"># [1] "objective:-1386.37718431741"</span>
<span class="co"># [1] "objective:-1386.36402706417"</span>
<span class="co"># [1] "objective:-1381.99570801785"</span>
<span class="co"># [1] "objective:-1381.86807518099"</span>
<span class="co"># [1] "objective:-1381.18590761063"</span>
<span class="co"># [1] "objective:-1381.18342754332"</span>
<span class="co"># [1] "objective:-1381.13344267982"</span>
<span class="co"># [1] "objective:-1381.13343270768"</span>
<span class="co"># [1] "objective:-1381.13113705137"</span>
<span class="co"># [1] "objective:-1381.1311369139"</span>
<span class="co"># [1] "objective:-1381.13106293456"</span></pre></body></html></div>
<div id="credible-sets" class="section level3">
<h3 class="hasAnchor">
<a href="#credible-sets" class="anchor"></a>Credible sets</h3>
<p>By default, we output 95% credible set:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">fitted</span>$<span class="no">sets</span>)
<span class="co"># $cs</span>
<span class="co"># $cs$L3</span>
<span class="co"># [1] 653</span>
<span class="co"># </span>
<span class="co"># $cs$L1</span>
<span class="co"># [1] 773 777</span>
<span class="co"># </span>
<span class="co"># $cs$L2</span>
<span class="co">#  [1] 362 372 373 374 379 381 383 384 386 387 388 389 391 392 396 397 398 399 400</span>
<span class="co"># [20] 401 403 404 405 407 408 415</span>
<span class="co"># </span>
<span class="co"># </span>
<span class="co"># $purity</span>
<span class="co">#    min.abs.corr mean.abs.corr median.abs.corr</span>
<span class="co"># L3    1.0000000     1.0000000       1.0000000</span>
<span class="co"># L1    0.9815726     0.9907863       0.9907863</span>
<span class="co"># L2    0.8686309     0.9673674       0.9756251</span>
<span class="co"># </span>
<span class="co"># $cs_index</span>
<span class="co"># [1] 3 1 2</span>
<span class="co"># </span>
<span class="co"># $coverage</span>
<span class="co"># [1] 0.9998995 0.9992271 0.9506579</span>
<span class="co"># </span>
<span class="co"># $requested_coverage</span>
<span class="co"># [1] 0.95</span></pre></body></html></div>
<p>The 3 causal signals have been captured by the 3 CS reported here. The 3rd CS contains many variables, including the true causal variable <code>403</code>. The minimum absolute correlation is 0.86.</p>
<p>If we use the default 90% coverage for credible sets, we still capture the 3 signals, but “purity” of the 3rd CS is now 0.91 and size of the CS is also a bit smaller.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">sets</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/susie_get_methods.html">susie_get_cs</a></span>(<span class="no">fitted</span>,
                     <span class="kw">X</span> <span class="kw">=</span> <span class="no">X</span>,
             <span class="kw">coverage</span> <span class="kw">=</span> <span class="fl">0.9</span>,
                     <span class="kw">min_abs_corr</span> <span class="kw">=</span> <span class="fl">0.1</span>)</pre></body></html></div>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">sets</span>)
<span class="co"># $cs</span>
<span class="co"># $cs$L3</span>
<span class="co"># [1] 653</span>
<span class="co"># </span>
<span class="co"># $cs$L1</span>
<span class="co"># [1] 773 777</span>
<span class="co"># </span>
<span class="co"># $cs$L2</span>
<span class="co">#  [1] 373 374 379 381 383 384 386 387 388 389 391 392 396 399 400 401 403 404 405</span>
<span class="co"># [20] 407 408</span>
<span class="co"># </span>
<span class="co"># </span>
<span class="co"># $purity</span>
<span class="co">#    min.abs.corr mean.abs.corr median.abs.corr</span>
<span class="co"># L3    1.0000000     1.0000000       1.0000000</span>
<span class="co"># L1    0.9815726     0.9907863       0.9907863</span>
<span class="co"># L2    0.9119572     0.9744588       0.9779763</span>
<span class="co"># </span>
<span class="co"># $cs_index</span>
<span class="co"># [1] 3 1 2</span>
<span class="co"># </span>
<span class="co"># $coverage</span>
<span class="co"># [1] 0.9998995 0.9992271 0.9046596</span>
<span class="co"># </span>
<span class="co"># $requested_coverage</span>
<span class="co"># [1] 0.9</span></pre></body></html></div>
</div>
<div id="posterior-inclusion-probabilities" class="section level3">
<h3 class="hasAnchor">
<a href="#posterior-inclusion-probabilities" class="anchor"></a>Posterior inclusion probabilities</h3>
<p>Previously we’ve determined that summing over 3 single effect regression models is approperate for our application. Here we summarize the variable selection results by posterior inclusion probability (PIP):</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="../reference/susie_plots.html">susie_plot</a></span>(<span class="no">fitted</span>, <span class="kw">y</span><span class="kw">=</span><span class="st">"PIP"</span>, <span class="kw">b</span><span class="kw">=</span><span class="no">b</span>)
<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span></pre></body></html></div>
<div class="figure" style="text-align: center">
<img src="finemapping_files/figure-html/unnamed-chunk-11-1.png" alt="&amp;nbsp;" width="600"><p class="caption">
 
</p>
</div>
<p>The true causal variables are colored red. The 95% CS identified are circled in different colors. Of interest is the cluster around position 400. The true signal is 403 but apparently it does not have the highest PIP. To compare ranking of PIP and original z-score in that CS:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">i</span>  <span class="kw">&lt;-</span> <span class="no">fitted</span>$<span class="no">sets</span>$<span class="no">cs</span><span class="kw">[[</span><span class="fl">3</span>]]
<span class="no">z3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">i</span>,<span class="no">z_scores</span>[<span class="no">i</span>],<span class="no">fitted</span>$<span class="no">pip</span>[<span class="no">i</span>])
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">z3</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'position'</span>, <span class="st">'z-score'</span>, <span class="st">'PIP'</span>)
<span class="no">z3</span>[<span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span>(<span class="no">z3</span>[,<span class="fl">2</span>], <span class="kw">decreasing</span> <span class="kw">=</span> <span class="fl">TRUE</span>),]
<span class="co">#       position  z-score        PIP</span>
<span class="co">#  [1,]      396 5.189811 0.06026797</span>
<span class="co">#  [2,]      381 5.164794 0.08444210</span>
<span class="co">#  [3,]      386 5.164794 0.08444210</span>
<span class="co">#  [4,]      379 5.077563 0.05804100</span>
<span class="co">#  [5,]      391 5.068388 0.06299894</span>
<span class="co">#  [6,]      383 5.057053 0.06048718</span>
<span class="co">#  [7,]      384 5.057053 0.06048718</span>
<span class="co">#  [8,]      389 5.052519 0.04925977</span>
<span class="co">#  [9,]      405 5.039617 0.05629383</span>
<span class="co"># [10,]      403 5.035949 0.03808209</span>
<span class="co"># [11,]      387 5.013526 0.04831886</span>
<span class="co"># [12,]      388 4.997955 0.04696986</span>
<span class="co"># [13,]      408 4.994865 0.05477586</span>
<span class="co"># [14,]      404 4.954407 0.04024608</span>
<span class="co"># [15,]      374 4.948060 0.03589437</span>
<span class="co"># [16,]      373 4.934410 0.02832642</span>
<span class="co"># [17,]      362 4.894243 0.01244577</span>
<span class="co"># [18,]      399 4.860780 0.03073966</span>
<span class="co"># [19,]      392 4.856384 0.02490617</span>
<span class="co"># [20,]      407 4.849285 0.02139881</span>
<span class="co"># [21,]      400 4.827361 0.02610013</span>
<span class="co"># [22,]      398 4.751205 0.01761845</span>
<span class="co"># [23,]      401 4.723184 0.02014360</span>
<span class="co"># [24,]      397 4.716886 0.01240547</span>
<span class="co"># [25,]      415 4.663208 0.01437857</span>
<span class="co"># [26,]      372 4.581560 0.01032276</span></pre></body></html></div>
</div>
<div id="choice-of-priors" class="section level3">
<h3 class="hasAnchor">
<a href="#choice-of-priors" class="anchor"></a>Choice of priors</h3>
<p>We found that SuSiE is generally robust to choice of priors. Here we set scaled prior variance (percentage of variance explained) to 0.2, and compare with previous results:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">fitted</span> <span class="kw">=</span> <span class="fu"><a href="../reference/susie.html">susie</a></span>(<span class="no">X</span>, <span class="no">Y</span>[,<span class="fl">1</span>],
               <span class="kw">L</span> <span class="kw">=</span> <span class="fl">10</span>,
               <span class="kw">estimate_residual_variance</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
               <span class="kw">estimate_prior_variance</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
               <span class="kw">scaled_prior_variance</span> <span class="kw">=</span> <span class="fl">0.2</span>)
<span class="fu"><a href="../reference/susie_plots.html">susie_plot</a></span>(<span class="no">fitted</span>, <span class="kw">y</span><span class="kw">=</span><span class="st">'PIP'</span>, <span class="kw">b</span><span class="kw">=</span><span class="no">b</span>)
<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span></pre></body></html></div>
<div class="figure" style="text-align: center">
<img src="finemapping_files/figure-html/unnamed-chunk-13-1.png" alt="&amp;nbsp;" width="600"><p class="caption">
 
</p>
</div>
<p>which largely remains unchanged. We also illustrate below analysis using default prior estimated from data,</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">fitted</span> <span class="kw">=</span> <span class="fu"><a href="../reference/susie.html">susie</a></span>(<span class="no">X</span>, <span class="no">Y</span>[,<span class="fl">1</span>],
               <span class="kw">L</span> <span class="kw">=</span> <span class="fl">10</span>,
               <span class="kw">estimate_residual_variance</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="../reference/susie_plots.html">susie_plot</a></span>(<span class="no">fitted</span>, <span class="kw">y</span><span class="kw">=</span><span class="st">'PIP'</span>, <span class="kw">b</span><span class="kw">=</span><span class="no">b</span>)
<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span>

<span class="co"># Warning in cumsum(sort(x, decreasing = TRUE)) &lt; coverage: longer object length</span>
<span class="co"># is not a multiple of shorter object length</span></pre></body></html></div>
<div class="figure" style="text-align: center">
<img src="finemapping_files/figure-html/unnamed-chunk-14-1.png" alt="&amp;nbsp;" width="600"><p class="caption">
 
</p>
</div>
</div>
<div id="a-note-on-covariate-adjustment" class="section level3">
<h3 class="hasAnchor">
<a href="#a-note-on-covariate-adjustment" class="anchor"></a>A note on covariate adjustment</h3>
<p>To include covariate <code>Z</code> in SuSiE, one approach is to regress it out from both <code>y</code> and <code>X</code>, and then run SuSiE on the residuals. The code below illustrates the procedure:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">remove.covariate.effects</span> <span class="kw">&lt;-</span> <span class="kw">function</span> (<span class="no">X</span>, <span class="no">Z</span>, <span class="no">y</span>) {
  <span class="co"># include the intercept term</span>
  <span class="kw">if</span> (<span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span>(<span class="no">Z</span>[,<span class="fl">1</span>]<span class="kw">!=</span><span class="fl">1</span>)) <span class="no">Z</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="fl">1</span>, <span class="no">Z</span>)
  <span class="no">A</span>   <span class="kw">&lt;-</span> <span class="fu">forceSymmetric</span>(<span class="fu"><a href="https://rdrr.io/r/base/crossprod.html">crossprod</a></span>(<span class="no">Z</span>))
  <span class="no">SZy</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span>(<span class="no">A</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">y</span> <span class="kw">%*%</span> <span class="no">Z</span>)))
  <span class="no">SZX</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span>(<span class="no">A</span>,<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">Z</span>) <span class="kw">%*%</span> <span class="no">X</span>))
  <span class="no">y</span> <span class="kw">&lt;-</span> <span class="no">y</span> - <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">Z</span> <span class="kw">%*%</span> <span class="no">SZy</span>)
  <span class="no">X</span> <span class="kw">&lt;-</span> <span class="no">X</span> - <span class="no">Z</span> <span class="kw">%*%</span> <span class="no">SZX</span>
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">X</span> <span class="kw">=</span> <span class="no">X</span>,<span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>,<span class="kw">SZy</span> <span class="kw">=</span> <span class="no">SZy</span>,<span class="kw">SZX</span> <span class="kw">=</span> <span class="no">SZX</span>))
}

<span class="no">out</span> <span class="kw">=</span> <span class="fu">remove.covariate.effects</span>(<span class="no">X</span>, <span class="no">Z</span>, <span class="no">Y</span>[,<span class="fl">1</span>])
<span class="no">fitted_adjusted</span> <span class="kw">=</span> <span class="fu"><a href="../reference/susie.html">susie</a></span>(<span class="no">out</span>$<span class="no">X</span>, <span class="no">out</span>$<span class="no">y</span>,
               <span class="kw">L</span> <span class="kw">=</span> <span class="fl">10</span>,
               <span class="kw">estimate_residual_variance</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p>Note that the covariates <code>Z</code> should have a column of ones as the first column. If not, the above function <code>remove.covariate.effects</code> will add such a column to <code>Z</code> before regressing it out. Data will be centered as a result. Also the scale of data is changed after regressing out <code>Z</code>. This introduces some subtleties in terms of interpreting the results. For this reason, we provide covariate adjustment procedure as a tip in the documentation and not part of <code><a href="../reference/susie.html">susieR::susie()</a></code> function. Cautions should be taken when applying this procedure and interpreting the result from it.</p>
</div>
</div>
<div id="session-information" class="section level2">
<h2 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session information</h2>
<p>Here are some details about the computing environment, including the versions of R, and the R packages, used to generate these results.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()
<span class="co"># R version 3.6.3 (2020-02-29)</span>
<span class="co"># Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co"># Running under: Linux Mint 20</span>
<span class="co"># </span>
<span class="co"># Matrix products: default</span>
<span class="co"># BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3</span>
<span class="co"># LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3</span>
<span class="co"># </span>
<span class="co"># locale:</span>
<span class="co">#  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span>
<span class="co">#  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span>
<span class="co">#  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span>
<span class="co">#  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span>
<span class="co">#  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
<span class="co"># [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span>
<span class="co"># </span>
<span class="co"># attached base packages:</span>
<span class="co"># [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co"># </span>
<span class="co"># other attached packages:</span>
<span class="co"># [1] susieR_0.9.52</span>
<span class="co"># </span>
<span class="co"># loaded via a namespace (and not attached):</span>
<span class="co">#  [1] Rcpp_1.0.5       highr_0.8        plyr_1.8.6       compiler_3.6.3  </span>
<span class="co">#  [5] pillar_1.4.6     tools_3.6.3      digest_0.6.25    evaluate_0.14   </span>
<span class="co">#  [9] memoise_1.1.0    lifecycle_0.2.0  tibble_3.0.3     gtable_0.3.0    </span>
<span class="co"># [13] lattice_0.20-40  pkgconfig_2.0.3  rlang_0.4.7      Matrix_1.2-18   </span>
<span class="co"># [17] yaml_2.2.1       pkgdown_1.5.1    xfun_0.13        stringr_1.4.0   </span>
<span class="co"># [21] dplyr_1.0.1      knitr_1.28       desc_1.2.0       generics_0.0.2  </span>
<span class="co"># [25] fs_1.3.2         vctrs_0.3.2      tidyselect_1.1.0 rprojroot_1.3-2 </span>
<span class="co"># [29] grid_3.6.3       reshape_0.8.8    glue_1.4.1       R6_2.4.1        </span>
<span class="co"># [33] rmarkdown_2.3    purrr_0.3.4      ggplot2_3.3.2    magrittr_1.5    </span>
<span class="co"># [37] backports_1.1.9  scales_1.1.1     htmltools_0.4.0  ellipsis_0.3.1  </span>
<span class="co"># [41] MASS_7.3-51.5    assertthat_0.2.1 colorspace_1.4-1 stringi_1.4.6   </span>
<span class="co"># [45] munsell_0.5.0    crayon_1.3.4</span></pre></body></html></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Gao Wang, Yuxin Zou, Kaiqian Zhang, Peter Carbonetto, Matthew Stephens.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
